# 微店(Weidian)集成指南

## 1. 注册微店开放平台账号

1. 访问 [微店开放平台](https://open.weidian.com/)
2. 注册开发者账号
3. 创建应用获取以下信息：
   - `App Key`
   - `App Secret`
   - `Shop ID` (店铺ID)

## 2. 微店API配置

### 环境变量配置
在 `.env.local` 文件中添加：

```env
# 微店 API 配置
WEIDIAN_APP_KEY=你的AppKey
WEIDIAN_APP_SECRET=你的AppSecret
WEIDIAN_SHOP_ID=你的店铺ID
WEIDIAN_API_URL=https://api.vdian.com/api
```

## 3. 微店商品设置

### 在微店后台创建两个商品：

#### 1. **定制卫衣** (¥99)
创建一个卫衣商品，设置多个颜色SKU：
- **颜色选项**：根据实际库存设置（如：白色、黑色、灰色、藏青色等）
- **尺码选项**：
  - S码: ¥99 (适合身高160-165cm，胸围88-92cm)
  - M码: ¥99 (适合身高165-170cm，胸围92-96cm)
  - L码: ¥99 (适合身高170-175cm，胸围96-100cm)
  - XL码: ¥99 (适合身高175-180cm，胸围100-104cm)

#### 2. **定制T恤** (¥49)
创建一个T恤商品，设置多个颜色SKU：
- **颜色选项**：根据实际库存设置（如：白色、黑色、灰色等）
- **尺码选项**：
  - S码: ¥49 (适合身高160-165cm，胸围88-92cm)
  - M码: ¥49 (适合身高165-170cm，胸围92-96cm)
  - L码: ¥49 (适合身高170-175cm，胸围96-100cm)
  - XL码: ¥49 (适合身高175-180cm，胸围100-104cm)

### 商品描述建议：
```
【定制说明】
- 采用高品质数码印花技术
- 图案清晰不褪色
- 纯棉材质，舒适透气
- 支持个性化定制设计
- 下单后3-5个工作日发货
```

## 4. API接口说明

### 主要使用的接口：

1. **创建订单** `vdian.order.create`
   - 自动创建订单并发送给商家

2. **查询订单** `vdian.order.get`
   - 获取订单详情和状态

3. **订单列表** `vdian.order.list.get`
   - 获取所有订单列表

4. **上传图片** `vdian.media.upload`
   - 上传定制设计图

## 5. 订单流程

```
用户下单 → API创建微店订单 → 商家微店后台接收订单 → 处理发货
```

## 6. 微店后台管理

### 订单管理入口：
- PC端：https://d.weidian.com/
- 手机端：微店APP

### 功能包括：
- 查看所有订单
- 修改订单状态
- 打印订单
- 批量发货
- 客户管理
- 数据统计

## 7. 支付配置

微店自带支付功能，支持：
- 微信支付
- 支付宝
- 银行卡支付

## 8. 物流配置

微店集成了主流快递公司：
- 顺丰速运
- 圆通快递
- 中通快递
- 韵达快递
- 申通快递
- 京东物流

## 9. 测试流程

1. 设置环境变量
2. 创建测试订单
3. 在微店后台查看订单
4. 测试订单状态更新
5. 测试退款流程

## 10. 注意事项

- API调用限制：每分钟60次
- 图片大小限制：单张不超过5MB
- 订单自动确认收货：15天
- 佣金：交易额的1-3%（根据套餐）

## 11. 常见问题

**Q: 如何获取Shop ID？**
A: 登录微店后台 → 店铺设置 → 基本信息

**Q: 订单同步延迟？**
A: 通常1-3秒内同步，高峰期可能延迟5秒

**Q: 如何处理退款？**
A: 微店后台直接处理，会自动同步状态